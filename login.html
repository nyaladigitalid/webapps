<!DOCTYPE html>

<html class="dark" lang="id"><head>
<script>(function(){try{var t=localStorage.getItem("theme");if(t==="light"){document.documentElement.classList.remove("dark");}else{document.documentElement.classList.add("dark");}}catch(e){document.documentElement.classList.add("dark");}})();</script>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Nyala Digital Apps - Login</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#ef7225",
                        "secondary": "#0d3b66",
                        "background-light": "#f5f7f8",
                        "background-dark": "#0b0e14",
                        "sidebar-dark": "#101922",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
<style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(14px);
            -webkit-backdrop-filter: blur(14px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .vibrant-gradient {
            background: linear-gradient(135deg, #ef7225 0%, #0d3b66 100%);
        }
        .vibrant-gradient:hover {
            opacity: 0.9;
        }
        .orb {
            position: absolute;
            width: 500px;
            height: 500px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(239, 114, 37, 0.15) 0%, rgba(239, 114, 37, 0) 70%);
            filter: blur(60px);
            z-index: 0;
        }
    </style>
</head>
<body class="bg-background-light text-slate-900 dark:bg-background-dark dark:text-white min-h-screen flex items-center justify-center overflow-hidden selection:bg-primary/30">
<div class="orb -top-20 -right-20"></div>
<div class="orb -bottom-40 -left-20" style="background: radial-gradient(circle, rgba(13, 59, 102, 0.15) 0%, rgba(13, 59, 102, 0) 70%);"></div>
<main class="relative z-10 w-full max-w-[480px] px-6 py-10">
<div class="flex flex-col items-center mb-8">
<div class="flex items-center gap-3 mb-3">
<div class="p-1.5 rounded-2xl bg-white/5 border border-white/10 shadow-lg shadow-black/40">
<img alt="Nyala Digital Logo" class="h-11 w-auto" src="img/logo.png"/>
</div>
<div class="space-y-0.5">
<h1 class="text-[22px] font-semibold tracking-tight text-white leading-tight">Nyala Digital Apps</h1>
<p class="text-[11px] uppercase tracking-[0.18em] text-primary/80 font-medium">Performance Marketing Suite</p>
</div>
</div>
<p class="text-[#8c8cb0] text-xs font-medium tracking-wide">Elevate your advertising workflow with one unified control center.</p>
</div>
<div class="glass-card rounded-2xl p-8 shadow-[0_18px_45px_rgba(0,0,0,0.65)] border border-white/10">
<div class="mb-8">
<h2 class="text-xl font-semibold text-white mb-1">Welcome back</h2>
<p class="text-[#6b6b88] text-sm">Sign in to your account to continue.</p>
</div>
<form class="space-y-6">
<!-- Email Input -->
<div class="space-y-2">
<label class="text-xs font-semibold text-gray-300 ml-1 tracking-wide" for="email">Email atau username</label>
<div class="relative group">
<div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
<span class="material-symbols-outlined text-[#6b6b88] text-xl group-focus-within:text-primary transition-colors">
                                person
                            </span>
</div>
<input class="block w-full bg-[#050510]/70 border border-[#223649] rounded-xl py-3.5 pl-12 pr-4 text-sm text-white placeholder-[#4a4a6a] focus:outline-none focus:ring-2 focus:ring-primary/40 focus:border-primary transition-all duration-200" id="email" placeholder="nama@perusahaan.com" type="text"/>
</div>
</div>
<!-- Password Input -->
<div class="space-y-2">
<div class="flex justify-between items-center ml-1">
<label class="text-xs font-semibold text-gray-300 tracking-wide" for="password">Password</label>
</div>
<div class="relative group">
<div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
<span class="material-symbols-outlined text-[#6b6b88] text-xl group-focus-within:text-primary transition-colors">
                                lock
                            </span>
</div>
<input class="block w-full bg-[#050510]/70 border border-[#223649] rounded-xl py-3.5 pl-12 pr-12 text-sm text-white placeholder-[#4a4a6a] focus:outline-none focus:ring-2 focus:ring-primary/40 focus:border-primary transition-all duration-200" id="password" placeholder="••••••••" type="password"/>
<button class="absolute inset-y-0 right-0 pr-4 flex items-center text-[#6b6b88] hover:text-white transition-colors" type="button">
<span class="material-symbols-outlined text-xl">
                                visibility
                            </span>
</button>
</div>
</div>
<div class="flex items-center justify-between">
<div class="flex items-center gap-2">
<input class="h-4 w-4 rounded border-[#223649] bg-[#050510] text-primary focus:ring-primary/40" id="remember-me" name="remember-me" type="checkbox"/>
<label class="ml-1 block text-[11px] text-[#8c8cb0]" for="remember-me">Ingat saya di perangkat ini</label>
</div>
<a class="text-[11px] font-semibold text-[#8c8cb0] hover:text-primary transition-colors" href="#">Lupa password?</a>
</div>
<button class="vibrant-gradient w-full py-3.5 px-6 rounded-xl text-white font-semibold text-sm shadow-lg shadow-primary/25 transform transition-all duration-150 active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-white/15 mt-3" type="submit">
Masuk ke dashboard
</button>
</form>
</div>
<p class="mt-8 text-center text-[12px] text-[#7a7a9b]">
Belum punya akun?
<a class="font-semibold text-primary hover:text-primary/80 hover:underline transition-all underline-offset-4" href="#">Hubungi tim Nyala Digital</a>
</p>
<div class="mt-10 flex justify-center gap-6 text-[10px] text-[#4a4a6a] uppercase tracking-[0.22em] font-semibold">
<a class="hover:text-primary transition-colors" href="#">Bantuan</a>
<a class="hover:text-primary transition-colors" href="#">Privasi</a>
<a class="hover:text-primary transition-colors" href="#">Syarat &amp; Ketentuan</a>
</div>
<p id="login-error" class="mt-4 text-xs text-red-400 bg-red-500/10 border border-red-500/30 rounded-xl px-3 py-2 hidden"></p>
</main>
<div class="fixed top-0 left-0 w-full h-full pointer-events-none opacity-20 overflow-hidden">
<div class="absolute inset-0 bg-[radial-gradient(#1a1a2e_1px,transparent_1px)] [background-size:40px_40px]"></div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var form = document.querySelector("form");
        var emailInput = document.getElementById("email");
        var passwordInput = document.getElementById("password");
        var rememberInput = document.getElementById("remember-me");
        var errorBox = document.getElementById("login-error");
        var passwordToggleButton = document.querySelector("#password + button");
        var submitButton = form ? form.querySelector('button[type="submit"]') : null;
        var passwordVisible = false;
        if (passwordToggleButton && passwordInput) {
            passwordToggleButton.addEventListener("click", function () {
                passwordVisible = !passwordVisible;
                passwordInput.type = passwordVisible ? "text" : "password";
            });
        }
        if (form && emailInput && passwordInput && submitButton) {
            console.log("Form and inputs found, adding listener");
            form.addEventListener("submit", async function (event) {
                console.log("Submit event fired");
                event.preventDefault();
                errorBox.classList.add("hidden");
                
                const email = emailInput.value.trim();
                const password = passwordInput.value;

                if (!email || !password) {
                    if (errorBox) {
                        errorBox.textContent = "Email/username dan password wajib diisi.";
                        errorBox.classList.remove("hidden");
                    }
                    return;
                }

                // Show loading state
                const originalText = submitButton.textContent;
                submitButton.disabled = true;
                submitButton.innerHTML = '<span class="material-symbols-outlined animate-spin text-sm">sync</span> Signing in...';

                try {
                    const response = await fetch('/api/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email, password })
                    });

                    const data = await response.json();

                    if (!response.ok) {
                        throw new Error(data.error || 'Login failed');
                    }

                    // Save user info
                    localStorage.setItem('user_id', data.user.id);
                    localStorage.setItem('user_name', data.user.name);
                    localStorage.setItem('user_email', data.user.email);
                    localStorage.setItem('role', data.user.role);

                    // Redirect
                    window.location.href = "index.html";
                } catch (err) {
                    console.error(err);
                    if (errorBox) {
                        errorBox.textContent = err.message || "Gagal masuk. Periksa kembali email dan password Anda.";
                        errorBox.classList.remove("hidden");
                    }
                    submitButton.disabled = false;
                    submitButton.textContent = originalText;
                }
            });
        }
    });
</script>
</body></html>
